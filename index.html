<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>金融ニュースナビ</title>
  <meta name="description" content="信頼できる金融ニュースを厳選し、カテゴリ別に素早く閲覧できるサイト。市場ニュース・企業ニュース・SNS投稿を横断表示。" />
  <meta property="og:title" content="金融ニュースナビ" />
  <meta property="og:description" content="信頼できる金融ニュースを厳選し、カテゴリ別に素早く閲覧。" />
  <meta property="og:type" content="website" />
  <meta name="color-scheme" content="light dark" />
  <link rel="icon" href="data:," />
  <link rel="preload" href="assets/data/news.json" as="fetch" crossorigin="anonymous" />
  <link rel="stylesheet" href="assets/styles.css" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="brand" href="./" aria-label="トップへ">
        金融ニュースナビ
      </a>
      <nav class="nav" aria-label="主要カテゴリ">
        <a href="#" data-filter="all" class="nav-link active" id="pill-all">📈 全ニュース</a>
        <a href="#" data-filter="market" class="nav-link" id="pill-market">🌐 市場・経済</a>
        <a href="#" data-filter="company" class="nav-link" id="pill-company">🏢 企業・決算</a>
        <a href="#" data-filter="sns" class="nav-link" id="pill-sns">💬 SNS速報</a>
      </nav>
      <div class="actions">
        <input id="search" type="search" placeholder="キーワード検索" aria-label="ニュース検索" />
        <select id="sort" aria-label="並び替え">
          <option value="date_desc">新しい順</option>
          <option value="date_asc">古い順</option>
          <option value="title_asc">タイトル昇順</option>
          <option value="title_desc">タイトル降順</option>
        </select>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="notice" role="note" aria-live="polite">
      掲載ルール: 実際にアクセス可能で内容確認済みのソースのみを掲載（整合性100%）
      <div class="section-links" style="margin-top:6px">
        <a href="legal/terms.html">利用規約</a>
        <a href="legal/disclaimer.html">免責事項</a>
      </div>
    </section>

    <!-- 統計とフィルタオプション -->
    <section class="notice stats-section" aria-label="統計情報">
      <div class="stats-grid">
        <div class="stat-item">
          <span class="stat-label">🌐 市場ニュース</span>
          <span class="stat-value" id="metric-market">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">🏢 企業ニュース</span>
          <span class="stat-value" id="metric-company">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">💬 SNS投稿</span>
          <span class="stat-value" id="metric-sns">0</span>
        </div>
        <div class="stat-item total">
          <span class="stat-label">📊 合計</span>
          <span class="stat-value" id="metric-total">0</span>
        </div>
        <div class="stat-item rating">
          <span class="stat-label">⭐ 情報充実度</span>
          <span class="stat-value" id="metric-rating">-</span>
        </div>
      </div>
      <div class="time-filter">
        <label class="time-filter-label">
          <input id="toggle-24h" type="checkbox" checked />
          ⏰ 24時間以内の最新ニュースのみ表示
        </label>
      </div>
    </section>

    <!-- 詳細フィルタ -->
    <section class="notice filter-section" aria-label="詳細フィルタ">
      <div class="filter-header">
        <h3>🔍 詳細フィルタ</h3>
        <button id="filter-toggle" class="filter-toggle">表示/非表示</button>
      </div>
      <form id="mece-filters" class="filter-form" style="display:none">
        <div class="filter-group">
          <label class="filter-label">
            📊 ニュース種別:
            <select id="type-filter" class="filter-select">
              <option value="all">すべて</option>
              <option value="earnings">📈 決算発表</option>
              <option value="disclosure">📋 適時開示・IR</option>
              <option value="fx">💱 為替・通貨</option>
              <option value="macro">🌍 経済指標・政策</option>
              <option value="equityIndex">📊 株価指数</option>
              <option value="companyNews">🏢 企業ニュース</option>
              <option value="marketNews">📈 市場ニュース</option>
            </select>
          </label>
          <label class="filter-label">
            🎯 対象範囲:
            <select id="issuer-filter" class="filter-select">
              <option value="all">すべて</option>
              <option value="withIssuer">🏢 特定企業</option>
              <option value="noIssuer">🌐 市場全般</option>
            </select>
          </label>
        </div>
        <div class="filter-options">
          <label class="filter-checkbox">
            <input id="dedupe-toggle" type="checkbox" checked />
            🔄 重複記事を除外
          </label>
        </div>
      </form>
    </section>

    <section id="cards" class="cards" aria-label="ニュース一覧">
      <!-- JSでカードを描画 -->
    </section>

    <section class="empty" id="empty" hidden>
      <div style="text-align: center; padding: 40px; color: var(--muted);">
        <div style="font-size: 48px; margin-bottom: 16px;">🔍</div>
        <h3>該当するニュースが見つかりません</h3>
        <p>フィルタ条件を変更するか、24時間フィルタを無効にしてお試しください。</p>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container footer-inner">
      <small>© 2025 金融ニュースナビ</small>
      <div class="footer-links">
        <a href="legal/terms.html">利用規約</a>
        <a href="legal/disclaimer.html">免責事項</a>
      </div>
    </div>
  </footer>

  <script>
    // フィルタUIとapp.jsの状態同期
    window.addEventListener('DOMContentLoaded', () => {
      const typeSel = document.getElementById('type-filter');
      const issuerSel = document.getElementById('issuer-filter');
      const dedupeCk = document.getElementById('dedupe-toggle');
      const within24hCk = document.getElementById('toggle-24h');
      const filterToggle = document.getElementById('filter-toggle');
      const filterForm = document.getElementById('mece-filters');
      
      // 詳細フィルタの表示/非表示
      filterToggle?.addEventListener('click', () => {
        const isHidden = filterForm.style.display === 'none';
        filterForm.style.display = isHidden ? 'flex' : 'none';
        filterToggle.textContent = isHidden ? '非表示' : '表示';
      });
      
      window.__NEWS_SET = (patch) => {
        // app.js 側の state を更新するための簡易ブリッジ（後方互換・安全策）
        const ev = new CustomEvent('news:set', { detail: patch });
        window.dispatchEvent(ev);
      };
      typeSel?.addEventListener('change', () => { window.__NEWS_SET && window.__NEWS_SET({ type: typeSel.value }); });
      issuerSel?.addEventListener('change', () => { window.__NEWS_SET && window.__NEWS_SET({ issuer: issuerSel.value }); });
      dedupeCk?.addEventListener('change', () => { window.__NEWS_SET && window.__NEWS_SET({ dedupe: dedupeCk.checked }); });
      within24hCk?.addEventListener('change', () => { window.__NEWS_SET && window.__NEWS_SET({ onlyWithin24h: within24hCk.checked }); });
    });
  </script>
  <script>
    // セクションのピル操作で上部ナビのフィルタも同期
    window.addEventListener('DOMContentLoaded', () => {
      const syncFilter = (filter) => {
        const ev = new CustomEvent('news:set', { detail: { filter } });
        window.dispatchEvent(ev);
      };
      const ids = [
        ['pill-all', 'all'],
        ['pill-market', 'market'],
        ['pill-company', 'company'],
        ['pill-sns', 'sns'],
      ];
      ids.forEach(([id, f]) => {
        const el = document.getElementById(id);
        el && el.addEventListener('click', (e) => {
          e.preventDefault();
          syncFilter(f);
        });
      });
    });
  </script>
  <script src="assets/app.js" type="module"></script>
</body>
</html>